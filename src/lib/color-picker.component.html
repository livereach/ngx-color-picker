<div #dialogPopup (click)="$event.stopPropagation()" [style.display]="hidden || !show ? 'none' : 'block'"
     [style.height.px]="cpHeight" [style.left.px]="left" [style.position]="position" [style.top.px]="top"
     class="color-picker">

  <div class="box">
    <select (change)="onGradientTypeChange($event)"
            [ngClass]="{'light-border': currentGradientType === 0}"
            class="form-control select-gradient-type"
            id="gradient-type" name="gradient-type">
      <option *ngFor="let gradient of gradientTypes | enumToArray; let id = index;"
              [selected]="id === currentGradientType"
              [value]="id">{{ gradient }}
      </option>
    </select>
    <select (change)="onDegChange($event)" *ngIf="currentGradientType === 0"
            class="form-control select-deg" id="deg" name="deg">
      <option *ngFor="let deg of degs;"
              [selected]="deg === baseGradient.deg"
              [value]="deg">{{ deg }}&deg;
      </option>
    </select>
    <div (click)="takeColor()" class="btn-icon btn-dropper"></div>
  </div>

  <div *ngIf="currentGradientType === 0 || currentGradientType === 1" class="gradient-box">
    <div #points class="points">
      <div (mousedown)="onGradientPointChange(id)"
           (contextmenu)="onRightClick(id, $event)"
           *ngFor="let gradientPoint of baseGradient.points; let id = index"
           [style.left.px]="gradientPoint.end"
           class="point-color-box">
        <div [style.background-color]="gradientPoint.color" class="point-color"></div>
      </div>
    </div>

    <div #deletePointMenu (click)="removePoint()"
         [style.left.px]="currentGradientPoint.end"
         class="delete-point-menu">
      <span>Delete Color</span>
      <span>Del</span>
    </div>

    <div #gradient (click)="createNewPoint($event)"
         [ngStyle]="{'background': gradientLine}"
         class="gradient">
    </div>

  </div>

  <div class="box">
    <div (dragEnd)="onDragEnd('saturation-lightness')" (dragStart)="onDragStart('saturation-lightness')"
         (newValue)="onColorChange($event)" *ngIf="(cpColorMode || 1) === 1" [rgX]="1"
         [rgY]="1" [slider] [style.background-color]="hueSliderColor" class="saturation-lightness">
      <div [style.left.px]="slider?.s" [style.top.px]="slider?.v" class="cursor"></div>
    </div>

    <div class="right">
      <div *ngIf="cpAlphaChannel==='disabled'"></div>

      <div #hueSlider (dragEnd)="onDragEnd('hue')" (dragStart)="onDragStart('hue')"
           (newValue)="onHueChange($event)" [rgX]="1" [rgY]="1"
           [slider] [style.display]="(cpColorMode || 1) === 1 ? 'block' : 'none'" class="hue">
        <div [style.top.px]="slider?.h" class="cursor"></div>
      </div>

      <div #valueSlider (dragEnd)="onDragEnd('value')" (dragStart)="onDragStart('value')"
           (newValue)="onValueChange($event)" [rgX]="1" [rgY]="1"
           [slider] [style.display]="(cpColorMode || 1) === 2 ? 'block': 'none'" class="value">
        <div [style.top.px]="slider?.v" class="cursor"></div>
      </div>

      <div #alphaSlider (dragEnd)="onDragEnd('alpha')" (dragStart)="onDragStart('alpha')"
           (newValue)="onAlphaChange($event)" [rgX]="1" [rgY]="1"
           [slider] [style.background-color]="alphaSliderColor"
           [style.display]="cpAlphaChannel === 'disabled' ? 'none' : 'block'" class="alpha">
        <div [style.top.px]="slider?.a" class="cursor"></div>
      </div>
    </div>
  </div>
  <div class="box">
    <select
            (change)="onFormatChange($event)"
            class="form-control select-format"
            id="dialogInputFormats" name="dialogInputFormats">
      <option *ngFor="let format of dialogInputFormats;" [value]="format.id">{{ format.name }}</option>
    </select>

    <div *ngIf="cpCmykEnabled && currentFormat == 3 && !cpDisableInput && (cpColorMode || 1) === 1"
         class="cmyk-text">
      <div class="box format">
        <input (keyup.enter)="onAcceptColor($event)" (newValue)="onCyanInput($event)" [rg]="100" [text]
               [value]="cmykText?.c" max="100" min="0"
               pattern="[0-9]*" type="text"/>
        <input (keyup.enter)="onAcceptColor($event)" (newValue)="onMagentaInput($event)" [rg]="100" [text]
               [value]="cmykText?.m" max="100" min="0"
               pattern="[0-9]*" type="text"/>
        <input (keyup.enter)="onAcceptColor($event)" (newValue)="onYellowInput($event)" [rg]="100" [text]
               [value]="cmykText?.y" max="100" min="0"
               pattern="[0-9]*" type="text"/>
        <input (keyup.enter)="onAcceptColor($event)" (newValue)="onBlackInput($event)" [rg]="100" [text]
               [value]="cmykText?.k" max="100" min="0"
               pattern="[0-9]*" type="text"/>
        <input (keyup.enter)="onAcceptColor($event)" (newValue)="onAlphaInput($event)"
               *ngIf="cpAlphaChannel!=='disabled'" [rg]="100"
               [text] [value]="cmykText?.a" max="100" min="0" pattern="^[0-9]{0,2}?$|^100$" step="1"
               type="text"/>
      </div>
    </div>

    <div *ngIf="currentFormat === 0 && !cpDisableInput && (cpColorMode || 1) === 1" [class.hex-alpha]="cpAlphaChannel==='forced'"
         class="hex-text">
      <div class="box format">
        <input (blur)="onHexInput(null)" (keyup.enter)="onAcceptColor($event)" (newValue)="onHexInput($event)"
               [text] [value]="hexText"/>
        <div class="input-icon input-icon-right">
          <input (keyup.enter)="onAcceptColor($event)" (newValue)="onAlphaInput($event)" [rg]="1" [text]
                 [value]="hexAlpha" max="100" maxlength="3" min="0" pattern="^[0-9]{0,2}?$|^100$"
                 step="1" type="text"/>
          <i>%</i>
        </div>
      </div>
    </div>

    <div *ngIf="currentFormat == 1 && !cpDisableInput && (cpColorMode || 1) === 1 " class="rgba-text">
      <div class="box format">
        <input (keyup.enter)="onAcceptColor($event)" (newValue)="onRedInput($event)" [rg]="255" [text]
               [value]="rgbaText?.r" max="255" min="0" pattern="[0-9]*" type="text"/>
        <input (keyup.enter)="onAcceptColor($event)" (newValue)="onGreenInput($event)" [rg]="255" [text]
               [value]="rgbaText?.g" max="255" min="0" pattern="[0-9]*" type="text"/>
        <input (keyup.enter)="onAcceptColor($event)" (newValue)="onBlueInput($event)" [rg]="255" [text]
               [value]="rgbaText?.b" max="255" min="0" pattern="[0-9]*" type="text"/>
        <input (keyup.enter)="onAcceptColor($event)" (newValue)="onAlphaInput($event)"
               *ngIf="cpAlphaChannel!=='disabled'" [rg]="100" [text] [value]="rgbaText?.a" max="100" min="0"
               pattern="^[0-9]{0,2}?$|^100$" step="1" type="text"/>
      </div>
    </div>

    <div *ngIf="currentFormat === 2 && !cpDisableInput && (cpColorMode || 1) === 1 " class="hsla-text">
      <div class="box format">
        <input (keyup.enter)="onAcceptColor($event)" (newValue)="onHueInput($event)" [rg]="360" [text]
               [value]="hslaText?.h" max="360" min="0" pattern="[0-9]*" type="text"/>
        <input (keyup.enter)="onAcceptColor($event)" (newValue)="onSaturationInput($event)" [rg]="100"
               [text] [value]="hslaText?.s" max="100" min="0" pattern="[0-9]*" type="text"/>
        <input (keyup.enter)="onAcceptColor($event)" (newValue)="onLightnessInput($event)" [rg]="100" [text]
               [value]="hslaText?.l" max="100" min="0" pattern="[0-9]*" type="text"/>
        <input (keyup.enter)="onAcceptColor($event)" (newValue)="onAlphaInput($event)"
               *ngIf="cpAlphaChannel!=='disabled'" [rg]="100" [text] [value]="hslaText?.a" max="100" min="0"
               pattern="^[0-9]{0,2}?$|^100$" step="1" type="text"/>
      </div>
    </div>

    <div (click)="onAddTemplateColors()"
         class="btn-icon btn-save" *ngIf="currentPalette === 0">
    </div>
  </div>

  <div *ngIf="cpPresetColors?.length || cpAddColorButton" class="preset-area">
    <hr>

    <div class="preset-label">{{cpPresetLabel}}</div>

    <div *ngIf="cpPresetColors?.length">
      <div (click)="setColorFromString(color)" *ngFor="let color of cpPresetColors"
           [style.backgroundColor]="color" class="preset-color">
        <span (click)="onRemovePresetColor($event, color)" *ngIf="cpAddColorButton"
              class="{{cpRemoveColorButtonClass}}"></span>
      </div>
    </div>

    <div *ngIf="!cpPresetColors?.length && cpAddColorButton"
         class="{{cpPresetEmptyMessageClass}}">{{cpPresetEmptyMessage}}</div>
  </div>

  <div *ngIf="cpOKButton || cpCancelButton" class="button-area">
    <button (click)="onCancelColor($event)" *ngIf="cpCancelButton" class="{{cpCancelButtonClass}}"
            type="button">{{cpCancelButtonText}}</button>

    <button (click)="onAcceptColor($event)" *ngIf="cpOKButton" class="{{cpOKButtonClass}}"
            type="button">{{cpOKButtonText}}</button>
  </div>

  <hr>
  <div *ngIf="cpEditMode !== modeState.EDITING" class="box">
    <select (change)="onPaletteChange($event.target)" class="form-control select-palette" name="palette">
      <option *ngFor="let palette of palettes | enumToArray; let id = index;" [selected]="currentPalette"
              [value]="id">{{palette}}</option>
    </select>
    <div (click)="toggleEditModeState()" *ngIf="currentPalette === 0"
         [ngClass]="{'btn-pencil-opacity': cpEditMode === modeState.EDIT}"
         class="btn-icon btn-pencil"></div>
  </div>

  <div class="box option-box">
    <div *ngIf="currentPalette === 0 && cpEditMode !== modeState.EDITING" class="templates">
      <div (click)="editTemplateColor(id)"
           *ngFor="let templateColor of getTemplateColors(); let id = index;"
           [ngClass]="{'template-opacity': cpEditMode === modeState.EDIT}"
           [ngStyle]="{'background': templateColor.color}" class="template">
        <div [ngClass]="{'edit': cpEditMode === modeState.EDIT}"></div>
      </div>
    </div>
    <div *ngIf="currentPalette === 1" class="last-used-colors">
      <div (click)="setLastUsedColor(id)"
           *ngFor="let lastUsedColor of getLastUsedColors(); let id = index;"
           [ngStyle]="{'background': lastUsedColor.color}" class="last-used-color">
      </div>
    </div>
  </div>

  <div *ngIf="cpEditMode === modeState.EDITING" class="color-swatch-box">
    <p>Edit Color</p>
    <div (click)="closeColorSwatchBox()" class="btn-icon btn-close"></div>

    <div [ngStyle]="{'background': currentTemplateColor.color}"
         class="color-swatch" id="colorSwatch">
    </div>

    <div (click)="deleteColor()" class="delete-color-btn">
      <div class="btn-trash"></div>
      <span>Delete Color</span>
    </div>
  </div>

</div>
